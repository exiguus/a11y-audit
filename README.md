# A11y Audit

## Overview

This repository contains a collection of tools and resources for conducting accessibility audits on web applications. The goal is to provide a comprehensive set of tools that can be used to identify and fix accessibility issues in web applications.

## Tools

- *SitemapScraper* This is a tool that generates a sitemap for a web application. It can be used to identify all the pages in a web application. It use the `sitemap.xml` file of the Website to generate a URL list. The URL list is generated by crawling the sitemap recursive.
- *Reporting* *htmlcs* and *axe* runners by Keyle - These are the main tools used for conducting accessibility audits. They can be used to identify and fix accessibility issues in web applications. They report WCAG 2.1 issues and provide detailed information about each issue, including the location of the issue in the code and suggestions for fixing it.
- *Results* - Provides a summary of the accessibility issues found in the web application. It includes a list of all the issues found, along with their severity and location in the code. The results can be used to prioritize the issues that need to be fixed.

## Getting Started

To get started with the tools, follow these steps:

1. Clone the repository to your local machine.
2. Pre-requisites:
   - Node.js > 22
   - Bun > 1.1.0
   - pnpm > 10
   - A web application to audit
3. Install the required dependencies using `pnpm exec playwright install` and `pnpm install`.
4. Copy the `.env.example` file to `.env`
5. Run the tools using the following command:

```bash
pnpm run a11y:audit
```

4. The results will be generated in the `results` directory. You can view the results in your web browser by opening the `index.html` file.
5. Use the results to identify and fix accessibility issues in your web application. The results include detailed information about each issue, including the location of the issue in the code and suggestions for fixing it.
6. Once you have fixed the issues, run the tools again to verify that the issues have been resolved.
7. Repeat the process until all accessibility issues have been resolved.

## Options

Options are stored in the `.env` file. The options are used to configure the tools and specify the web application to audit. The options include:

```text
ORIGIN="www.gattner.name"
BACKUP_PATH="./backups"
REPORT_PATH="./reports"
RESULTS_PATH="./results"
RESULTS_IGNORE_WARNING="true"
SITEMAP_PATH="./sitemaps"
SITEMAP_URLS='[]'
URL_LIST='["https://www.gattner.name/", "https://www.gattner.name/about", "https://www.gattner.name/contact", "https://www.gattner.name/impressum"]'
TIMEOUT=30000
LANGUAGE="en"
```

- ORIGIN: The origin of the web application to audit. This is used to generate subdirectories and file names for the results.
- SITEMAP_URLS or URL_LIST: The list of URLs to audit. If SITEMAP_URLS is set, the tool will use the sitemap to generate the URL list. If URL_LIST is set, the tool will use the URL list directly. If both are set, the tool will use both.

Options to configure the browser and the audit can be found in the `report.config.ts` file. The options include:

```typescript
export const defaultConfig: Partial<CrawlConfig> = {
	browserConfig: {
		headless: true,
		timeout: process.env.TIMEOUT ? Number.parseInt(process.env.TIMEOUT) : 30000,
	},
	kayleConfig: {
		includeWarnings: true,
		waitUntil: "networkidle",
		runners: ["htmlcs", "axe"],
		standard: Standard.WCAG2AA,
		timeout: process.env.TIMEOUT ? Number.parseInt(process.env.TIMEOUT) : 30000,
		language: process.env.LANGUAGE || "en",
	},
};
```

## Usage

```bash
pnpm run a11y:audit
```

### Scraper

```bash
pnpm run a11y:audit:scrape
```

The scraper is used to generate a sitemap for a web application. It can be used to identify all the pages in a web application. The scraper uses the `sitemap.xml` file of the website to generate a URL list. The URL list is generated by crawling the sitemap recursively.

### Reporting

```bash
pnpm run a11y:audit:report
```

The reporting tools are used to conduct accessibility audits. They can be used to identify and fix accessibility issues in web applications. The reporting tools use the `htmlcs` and `axe` runners by Keyle to report WCAG 2.1 issues. The reports provide detailed information about each issue, including the location of the issue in the code and suggestions for fixing it.

### Results

```bash
pnpm run a11y:audit:result
```

The results provide a summary of the accessibility issues found in the web application. The results include a list of all the issues found, along with their severity and location in the code. The results can be used to prioritize the issues that need to be fixed.

### Backup

```bash
pnpm run a11y:audit:backup
```

The backup command is used to create a backup of the results and sitemaps.
Backups are compressed and stored with timestamps.

### Cleanup

```bash
pnpm run a11y:audit:cleanup
```

The cleanup command is used to remove all the results and sitemaps. This command is useful for cleaning up the results and sitemaps after the audit is complete.

### crawl.sh

Recursive crawl a website and generate a sitemap.txt file.

```bash
./scripts/crawl.sh https://www.example.org
```

The `crawl.sh` script use wget to recursively crawl a website and generate a `sitemap.txt` file. The file can be used to manualy export the `URL_LIST` with  `export URL_LIST=$(jq -R < sitemap.txt | jq -s .)`.
It can be used if a `sitemap.xml` file is not available.

## Additional Resources

- [WCAG 2.1 Guidelines](https://www.w3.org/TR/WCAG21/)
- [WCAG 2.2 Guidelines](https://www.w3.org/TR/WCAG22/)
- [W3C Web Accessibility Initiative (WAI)](https://www.w3.org/WAI/)
- [EN 301 549 Harmonisierte EuropÃ¤sche Norm](https://www.barrierefreiheit-dienstekonsolidierung.bund.de/Webs/PB/DE/gesetze-und-richtlinien/en301549/en301549-node.html)
- [AXE](https://www.deque.com/axe/)
- [kayle](https://github.com/a11ywatch/kayle)
- [WAVE](https://wave.webaim.org/)
